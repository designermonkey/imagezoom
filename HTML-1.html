<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN">

<html>
<head>
	<meta http-equiv="Content-type" content="text/html; charset=us-ascii">

	<title>Coordinates!</title>
	<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.6/jquery.js" type="text/javascript">
</script>
	<script type="text/javascript">
	$(document).ready( function() {
		
		function point(element, event){
			var offset = element.offset();
			return {
				x: (event.pageX - offset.left),
				y: (event.pageY - offset.top)
			}
		}
		var options = {
			image_selector: '#surface img',
			zoom_width: 1000,
			zoom_height: 1000,
		}
		
		$(options.image_selector).each(function()
		{
			var $self = $(this);
			
			options = $.extend(options, {
				initial_width: parseInt($self.width()),
				initial_height: parseInt($self.height())
			});
			
			//console.log(options);
			
			$self.mousemove(function(event)
			{
				var mousepos = point($(this), event);
				
				$('#livex').text(mousepos.x);
				$('#livey').text(mousepos.y);
			});
			
			$self.click(function(event)
			{
				var new_x = null;
				var new_y = null;
				var new_left = null;
				var new_top = null;
				
				if($(this).hasClass('zoomed')){
					var clickpos = point($(this), event);
					new_x = clickpos.x;
					new_y = clickpos.y;
					new_left = (options.initial_width/2) - new_x;
					new_top = (options.initial_height/2) - new_y;
					$("#new_x").text( new_x );
					$("#new_y").text( new_y );
					$("#new_left").text( new_left );
					$("#new_top").text( new_top );
					$(this).animate({
						'left': new_left,
						'top': new_top
					});
				}
				else{
					var clickpos = point($(this), event);
					new_x = clickpos.x * (options.zoom_width/options.initial_width);
					new_y = clickpos.y * (options.zoom_height/options.initial_height);
					new_left = (options.initial_width/2) - new_x;
					new_top = (options.initial_height/2) - new_y;
					$("#new_x").text( new_x );
					$("#new_y").text( new_y );
					$("#new_left").text( new_left );
					$("#new_top").text( new_top );
					$(this).animate({
						'left': new_left,
						'top': new_top,
						'width': options.zoom_width,
						'height': options.zoom_height
					}).addClass('zoomed');
				}
				
			});
		});
	});
	</script>
	<style type="text/css" media="screen">
	body{
		margin: 50px;
	}
	#surface {
		background-color: transparent;
		width: 425px;
		height: 425px;
		overflow: hidden;
		border: 1px solid #000;
		float: left;
	}
	#surface img {
		position: relative;
	}
	#info {
		width: 300px;
		float: right;
	}
	</style>
</head>

<body>
	<div id="surface">
		<img src="map-trial.png" width="425" />
	</div>
	<div id="info">
		<p>mouse X: <span id="livex"></span></p>
		<p>mouse Y: <span id="livey"></span></p>
		<br />
		<p>new X: <span id="new_x"></span></p>
		<p>new Y: <span id="new_y"></span></p>
		<br />
		<p>new left: <span id="new_left"></span></p>
		<p>new top: <span id="new_top"></span></p>
	</div>
</body>
</html>
